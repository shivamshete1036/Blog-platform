<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <meta charset="UTF-8">
    <title> Blog Homepage</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .post-summary { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
    </style>
</head>
<body class="bg-light">
<nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container">
        <a class="navbar-brand" href="/">My Blog</a>
        <div class="navbar-nav ms-auto">
            <div th:if="${#authorization.expression('isAnonymous()')}" class="d-flex">
                <a class="nav-link" href="/login">Login</a>
                <a class="nav-link btn btn-primary text-white ms-2" href="/register">Register</a>
            </div>

            <div th:if="${#authorization.expression('isAuthenticated()')}" class="d-flex align-items-center">
                <span class="text-light me-3">Welcome, <span th:text="${#authentication.name}">User</span>!</span>
                <a class="nav-link" href="/new-post">New Post</a>

                <form th:action="@{/logout}" method="post" class="ms-2">
                    <button type="submit" class="btn btn-outline-danger btn-sm">Logout</button>
                </form>
            </div>
        </div>
    </div>
</nav>

<div class="container">
    <<div th:each="post : ${posts}" class="card mb-3 shadow-sm">
    <div class="card-body">
        <h2 th:text="${post.title}">Post Title</h2>

        <p class="text-muted small">
            By: <span th:text="${post.author.username}">Author Name</span>
        </p>

        <p th:text="${#strings.abbreviate(post.content, 150)}">Post Content Summary...</p>

        <div class="d-flex gap-2">
            <a th:href="@{/post/{id}(id=${post.id})}" class="btn btn-primary btn-sm">Read More</a>

            <div th:if="${#authentication.name == post.author.username}" class="d-flex gap-2">
                <a th:href="@{/post/edit/{id}(id=${post.id})}" class="btn btn-warning btn-sm">Edit</a>
                <a th:href="@{/post/delete/{id}(id=${post.id})}"
                   class="btn btn-danger btn-sm"
                   onclick="return confirm('Are you sure you want to delete this post?')">Delete</a>
            </div>
        </div>
    </div>
</div>
    </div>

    <div th:if="${#lists.isEmpty(posts)}" class="text-center mt-5">
        <p class="text-muted">No posts found. Start by creating one!</p>
    </div>
</div>
</body>
</html>